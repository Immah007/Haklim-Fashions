<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6222074240044248" crossorigin="anonymous"></script>
    <title>Boutiql | Curated Luxury & Artisan Finds</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@splidejs/splide@4.1.4/dist/css/splide.min.css">
    <style>
        :root {
            --primary: #8a6e5a;
            --primary-dark: #6d5544;
            --secondary: #d4b8a0;
            --accent: #c19a6b;
            --light: #f8f4f0;
            --dark: #3a2c2a;
            --gray: #8c7e75;
            --light-gray: #eae4dd;
            --success: #8a9a5b;
            --warning: #d4a55e;
            --danger: #b86b6b;
            --radius: 8px;
            --shadow: 0 3px 8px rgba(138, 110, 90, 0.08);
            --shadow-lg: 0 8px 20px rgba(138, 110, 90, 0.12);
            --transition: all 0.3s ease;
            --toast-success: #8a9a5b;
            --toast-error: #b86b6b;
            --toast-info: #8a6e5a;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', sans-serif;
        }

        body {
            font-family: 'Poppins', sans-serif;
            line-height: 1.6;
            color: var(--dark);
            background-color: #fefefb;
            overflow-x: hidden;
        }

        a {
            text-decoration: none;
            color: inherit;
        }

        ul {
            list-style: none;
        }

        button {
            cursor: pointer;
            border: none;
            outline: none;
            font-family: inherit;
        }

        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 15px;
        }

        /* Toast Notifications */
        .toast-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 9999;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .toast {
            min-width: 300px;
            max-width: 400px;
            background: white;
            border-radius: var(--radius);
            box-shadow: var(--shadow-lg);
            padding: 15px 20px;
            display: flex;
            align-items: center;
            gap: 12px;
            animation: slideIn 0.3s ease;
            border-left: 4px solid;
            position: relative;
            overflow: hidden;
        }

        .toast.success {
            border-left-color: var(--toast-success);
        }

        .toast.error {
            border-left-color: var(--toast-error);
        }

        .toast.info {
            border-left-color: var(--toast-info);
        }

        .toast-icon {
            font-size: 20px;
        }

        .toast.success .toast-icon {
            color: var(--toast-success);
        }

        .toast.error .toast-icon {
            color: var(--toast-error);
        }

        .toast.info .toast-icon {
            color: var(--toast-info);
        }

        .toast-content {
            flex: 1;
        }

        .toast-title {
            font-weight: 600;
            font-size: 14px;
            margin-bottom: 4px;
        }

        .toast-message {
            font-size: 13px;
            color: var(--gray);
        }

        .toast-progress {
            position: absolute;
            bottom: 0;
            left: 0;
            height: 3px;
            background: var(--primary);
            animation: progress 3s linear forwards;
        }

        .toast.success .toast-progress {
            background: var(--toast-success);
        }

        .toast.error .toast-progress {
            background: var(--toast-error);
        }

        .toast.info .toast-progress {
            background: var(--toast-info);
        }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @keyframes progress {
            from {
                width: 100%;
            }
            to {
                width: 0%;
            }
        }

        /* Header Styles - ORIGINAL */
        header {
            background-color: white;
            box-shadow: 0 2px 10px rgba(138, 110, 90, 0.15);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            flex-wrap: wrap;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 26px;
            font-weight: 700;
            color: var(--primary);
            letter-spacing: 1px;
        }

        .logo img {
            height: 2.5rem;
        }

        .search-bar {
            flex: 1;
            max-width: 450px;
            margin: 0 20px;
            position: relative;
            min-width: 200px;
            display: flex;
            align-items: center;
        }

        .search-bar input {
            width: 100%;
            padding: 10px 15px;
            outline: none;
            border-radius: var(--radius);
            border: 1px solid var(--light-gray);
            font-size: 14px;
            transition: var(--transition);
            background: var(--light);
        }

        .search-bar input:focus {
            border: 1px solid var(--primary);
            box-shadow: 0 0 0 2px rgba(138, 110, 90, 0.1);
        }

        .search-bar button {
            position: absolute;
            right: 5px;
            background: var(--primary);
            color: white;
            border-radius: 4px;
            padding: 4px 9px;
            display: flex;
            align-items: center;
            gap: 3px;
            justify-content: center;
            transition: var(--transition);
        }

        .search-bar button:hover {
            background: var(--primary-dark);
        }

        .header-actions {
            display: flex;
            gap: 15px;
        }

        .action-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            font-size: 12px;
            color: var(--gray);
            transition: var(--transition);
            padding: 5px;
            position: relative;
        }

        .action-btn i {
            font-size: 20px;
            margin-bottom: 4px;
        }

        .action-btn:hover {
            color: var(--primary);
        }

        .cart-count {
            position: absolute;
            top: -5px;
            right: -5px;
            background: var(--danger);
            color: white;
            font-size: 11px;
            font-weight: 600;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 2px solid white;
        }

        .mobile-menu-btn {
            display: none;
            background: none;
            font-size: 24px;
            color: var(--gray);
        }

        /* Hero Section - ORIGINAL */
        .hero {
            background: linear-gradient(135deg, #f8f4f0 0%, #eae4dd 100%);
            color: var(--dark);
            padding: 60px 0;
            margin-bottom: 40px;
            border-radius: 0 0 var(--radius) var(--radius);
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .hero::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 100%;
            background-image: url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M11 18c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm48 25c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm-43-7c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm63 31c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM34 90c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm56-76c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM12 86c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm28-65c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm23-11c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-6 60c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm29 22c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zM32 63c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm57-13c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-9-21c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM60 91c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM35 41c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM12 60c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2z' fill='%238a6e5a' fill-opacity='0.03' fill-rule='evenodd'/%3E%3C/svg%3E");
            opacity: 0.5;
        }

        .hero-content {
            max-width: 700px;
            margin: 0 auto;
            position: relative;
            z-index: 1;
        }

        .hero h1 {
            font-size: 42px;
            margin-bottom: 20px;
            line-height: 1.2;
            font-weight: 600;
            letter-spacing: 1px;
        }

        .hero p {
            font-size: 18px;
            margin-bottom: 30px;
            color: var(--gray);
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        .btn {
            display: inline-block;
            padding: 12px 28px;
            border-radius: var(--radius);
            font-weight: 600;
            transition: var(--transition);
            font-size: 14px;
            letter-spacing: 0.5px;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
            background: var(--primary-dark);
        }

        .btn-outline {
            background: transparent;
            color: var(--primary);
            border: 1px solid var(--primary);
            margin-left: 15px;
        }

        .btn-outline:hover {
            background: var(--primary);
            color: white;
        }

        /* Categories Section - ORIGINAL */
        .section {
            padding: 50px 0;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .section-title {
            font-size: 28px;
            font-weight: 600;
            color: var(--dark);
            letter-spacing: 0.5px;
        }

        .view-all {
            color: var(--primary);
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 14px;
        }

        .categories-container {
            overflow-x: auto;
            padding-bottom: 10px;
        }

        .categories-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
            gap: 20px;
        }

        .category-card {
            background: white;
            border-radius: var(--radius);
            padding: 20px 15px;
            text-align: center;
            box-shadow: var(--shadow);
            transition: var(--transition);
            cursor: pointer;
            border: 1px solid var(--light-gray);
        }

        .category-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
            border-color: var(--secondary);
        }

        .category-icon {
            width: 60px;
            height: 60px;
            background: var(--light);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 15px;
            font-size: 24px;
            color: var(--primary);
            border: 1px solid var(--secondary);
        }

        .category-name {
            font-weight: 600;
            margin-bottom: 5px;
            font-size: 15px;
        }

        .category-count {
            font-size: 13px;
            color: var(--gray);
        }

        /* Featured Products - ORIGINAL LAYOUT RESTORED */
        .products-grid {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 8px;
        }

        .product-card {
            background: white;
            width: 100%;
            padding: 4px;
            border-radius: var(--radius);
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: var(--transition);
            cursor: pointer;
            display: flex;
            flex-direction: column;
            border: 1px solid var(--light-gray);
        }

        .product-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
            border-color: var(--secondary);
        }

        .product-image {
            height: 200px;
            width: 100%;
            background: var(--light);
            position: relative;
            overflow: hidden;
        }

        .product-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: var(--transition);
        }

        .product-card:hover .product-image img {
            transform: scale(1.05);
        }

        .product-badge {
            position: absolute;
            top: 10px;
            left: 10px;
            background: var(--accent);
            color: white;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 600;
            letter-spacing: 0.5px;
        }

        .product-wishlist {
            position: absolute;
            top: 10px;
            right: 10px;
            width: 32px;
            height: 32px;
            background: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--gray);
            transition: var(--transition);
            z-index: 2;
            border: 1px solid var(--light-gray);
        }

        .product-wishlist:hover, .product-wishlist.active {
            color: var(--danger);
            border-color: var(--danger);
        }

        .product-info {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }

        .product-category {
            font-size: 11px;
            color: var(--gray);
            text-transform: uppercase;
            margin-bottom: 8px;
            letter-spacing: 0.5px;
            font-weight: 500;
        }

        .product-title {
            font-weight: 600;
            margin-bottom: 1px;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            font-size: 15px;
            line-height: 1.4;
            flex-grow: 1;
        }

        .product-price {
            font-weight: 700;
            font-size: 18px;
            color: var(--primary);
            margin-bottom: 1px;
        }

        .product-price-old {
            font-size: 14px;
            color: var(--gray);
            text-decoration: line-through;
            margin-right: 8px;
            font-weight: 400;
        }

        .product-discount {
            color: var(--danger);
            font-weight: 600;
            font-size: 13px;
        }

        .product-actions {
            margin-top: auto;
        }

        .btn-add-to-cart {
            width: 100%;
            padding: 6px;
            background: var(--primary);
            color: white;
            border-radius: 4px;
            font-weight: 600;
            font-size: 13px;
            transition: var(--transition);
            letter-spacing: 0.5px;
        }

        /* Pagination - ORIGINAL STYLE */
        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 40px;
            gap: 10px;
            flex-wrap: wrap;
        }

        .pagination-btn {
            width: 40px;
            height: 40px;
            border-radius: var(--radius);
            display: flex;
            align-items: center;
            justify-content: center;
            background: white;
            color: var(--dark);
            box-shadow: var(--shadow);
            transition: var(--transition);
            border: 1px solid var(--light-gray);
            font-size: 14px;
            cursor: pointer;
        }

        .pagination-btn.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .pagination-btn:hover:not(.active):not(:disabled) {
            background: var(--light);
            border-color: var(--secondary);
        }

        .pagination-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* How It Works - ORIGINAL */
        .how-it-works {
            background: var(--light);
            border-radius: var(--radius);
            border: 1px solid var(--light-gray);
        }

        .steps {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
        }

        .step {
            text-align: center;
            padding: 30px 20px;
        }

        .step-number {
            width: 60px;
            height: 60px;
            background: var(--primary);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            font-weight: 700;
            margin: 0 auto 20px;
            border: 2px solid var(--secondary);
        }

        .step-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 10px;
            color: var(--dark);
        }

        .step-description {
            color: var(--gray);
            font-size: 14px;
        }

        /* Testimonials - SPLIDE CAROUSEL */
        .testimonials {
            background: linear-gradient(135deg, #8a6e5a 0%, #6d5544 100%);
            color: white;
            border-radius: var(--radius);
            overflow: hidden;
            position: relative;
            padding: 50px 0;
        }

        .testimonials .section-title {
            color: white;
            margin-bottom: 30px;
        }

        .splide__slide {
            padding: 10px;
        }

        .testimonial-card {
            background: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(10px);
            border-radius: var(--radius);
            padding: 30px;
            transition: var(--transition);
            border: 1px solid rgba(255, 255, 255, 0.1);
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        .testimonial-card:hover {
            transform: translateY(-5px);
            background: rgba(255, 255, 255, 0.12);
        }

        .testimonial-text {
            font-style: italic;
            margin-bottom: 20px;
            line-height: 1.7;
            font-size: 15px;
            flex-grow: 1;
        }

        .testimonial-author {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-top: auto;
        }

        .author-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--light);
            overflow: hidden;
            border: 2px solid var(--secondary);
            flex-shrink: 0;
        }

        .author-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .author-info {
            min-width: 0;
        }

        .author-info h4 {
            font-weight: 600;
            margin-bottom: 5px;
            font-size: 16px;
        }

        .author-info p {
            font-size: 13px;
            opacity: 0.8;
        }

        /* Splide Custom Arrows */
        .splide__arrow {
            background: rgba(255, 255, 255, 0.2) !important;
            backdrop-filter: blur(10px);
            width: 40px !important;
            height: 40px !important;
            transition: var(--transition) !important;
        }

        .splide__arrow:hover {
            background: rgba(255, 255, 255, 0.4) !important;
        }

        .splide__arrow svg {
            fill: white !important;
        }

        .splide__pagination__page {
            background: rgba(255, 255, 255, 0.3) !important;
            transition: var(--transition) !important;
        }

        .splide__pagination__page.is-active {
            background: white !important;
            transform: scale(1.2) !important;
        }

        /* Chat System - ORIGINAL */
        .chat-container {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
        }

        .chat-button {
            width: 60px;
            height: 60px;
            background: var(--primary);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            box-shadow: var(--shadow-lg);
            transition: var(--transition);
            border: 2px solid var(--secondary);
            position: relative;
        }

        .chat-button:hover {
            transform: scale(1.1);
            background: var(--primary-dark);
        }

        .chat-button.offline {
            background: var(--gray);
        }

        .chat-button.offline:hover {
            background: var(--dark);
        }

        .chat-status-badge {
            position: absolute;
            bottom: 2px;
            right: 2px;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            border: 2px solid white;
        }

        .chat-status-badge.online {
            background: var(--success);
        }

        .chat-status-badge.offline {
            background: var(--gray);
        }

        .chat-window {
            position: absolute;
            bottom: 70px;
            right: 0;
            width: 350px;
            height: 500px;
            background: white;
            border-radius: var(--radius);
            box-shadow: var(--shadow-lg);
            display: none;
            flex-direction: column;
            overflow: hidden;
            border: 1px solid var(--light-gray);
        }

        .chat-window.active {
            display: flex;
        }

        .chat-header {
            background: var(--primary);
            color: white;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .chat-header h3 {
            font-size: 16px;
            font-weight: 600;
            letter-spacing: 0.5px;
        }

        .chat-header h3 i {
            margin-right: 8px;
        }

        .chat-close {
            background: none;
            color: white;
            font-size: 18px;
        }

        .chat-support-info {
            padding: 15px;
            background: var(--light);
            border-bottom: 1px solid var(--light-gray);
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .support-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--primary);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
            border: 2px solid var(--secondary);
            flex-shrink: 0;
        }

        .support-details {
            flex: 1;
        }

        .support-details h4 {
            font-size: 15px;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .support-details p {
            font-size: 12px;
            color: var(--gray);
        }

        .support-status {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            margin-right: 5px;
        }

        .support-status.online {
            background: var(--success);
        }

        .support-status.offline {
            background: var(--gray);
        }

        .support-hours {
            font-size: 11px;
            color: var(--gray);
            margin-top: 4px;
        }

        .chat-messages {
            flex: 1;
            padding: 15px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 15px;
            background: #f9f9f9;
        }

        .message {
            max-width: 80%;
            padding: 10px 15px;
            border-radius: 18px;
            font-size: 14px;
            line-height: 1.4;
            position: relative;
            word-wrap: break-word;
        }

        .message.support {
            align-self: flex-start;
            background: white;
            color: var(--dark);
            border-bottom-left-radius: 5px;
            border: 1px solid var(--light-gray);
            box-shadow: var(--shadow);
        }

        .message.customer {
            align-self: flex-end;
            background: var(--primary);
            color: white;
            border-bottom-right-radius: 5px;
        }

        .message.system {
            align-self: center;
            background: var(--light-gray);
            color: var(--gray);
            font-size: 12px;
            border-radius: 12px;
            max-width: 90%;
            text-align: center;
        }

        .message-time {
            font-size: 10px;
            margin-top: 5px;
            opacity: 0.7;
        }

        .chat-input-area {
            display: flex;
            padding: 15px;
            border-top: 1px solid var(--light-gray);
            background: white;
        }

        .chat-input-area input {
            flex: 1;
            padding: 12px 15px;
            border: 1px solid var(--light-gray);
            border-radius: var(--radius);
            font-size: 14px;
            background: var(--light);
        }

        .chat-input-area input:focus {
            outline: none;
            border-color: var(--primary);
        }

        .chat-input-area input:disabled {
            background: var(--light-gray);
            cursor: not-allowed;
        }

        .chat-send {
            background: var(--primary);
            color: white;
            width: 45px;
            height: 45px;
            border-radius: var(--radius);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-left: 10px;
            transition: var(--transition);
        }

        .chat-send:hover:not(:disabled) {
            background: var(--primary-dark);
        }

        .chat-send:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .offline-message-form {
            padding: 20px;
            background: var(--light);
            border-top: 1px solid var(--light-gray);
        }

        .offline-message-form textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--light-gray);
            border-radius: var(--radius);
            font-family: inherit;
            font-size: 14px;
            margin-bottom: 10px;
            resize: vertical;
            background: white;
        }

        .offline-message-form input {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--light-gray);
            border-radius: var(--radius);
            font-size: 14px;
            margin-bottom: 10px;
            background: white;
        }

        .offline-message-form button {
            width: 100%;
            padding: 12px;
            background: var(--primary);
            color: white;
            border-radius: var(--radius);
            font-weight: 600;
            transition: var(--transition);
        }

        .offline-message-form button:hover {
            background: var(--primary-dark);
        }

        /* Modals - ORIGINAL */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(58, 44, 42, 0.7);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            padding: 20px;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: var(--radius);
            max-width: 800px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
            box-shadow: var(--shadow-lg);
            border: 1px solid var(--light-gray);
        }

        .modal-header {
            padding: 20px;
            border-bottom: 1px solid var(--light-gray);
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            background: white;
            z-index: 10;
        }

        .modal-close {
            background: none;
            font-size: 24px;
            color: var(--gray);
            cursor: pointer;
        }

        .modal-body {
            padding: 20px;
        }

        .product-detail {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }

        .product-detail-image {
            border-radius: var(--radius);
            overflow: hidden;
            border: 1px solid var(--light-gray);
        }

        .product-detail-image img {
            width: 100%;
            height: auto;
            display: block;
        }

        .product-detail-info h2 {
            font-size: 24px;
            margin-bottom: 10px;
            color: var(--dark);
        }

        .product-detail-price {
            font-size: 28px;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 15px;
        }

        .product-detail-description {
            margin-bottom: 20px;
            line-height: 1.6;
            color: var(--gray);
        }

        .product-detail-meta {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
            font-size: 14px;
            color: var(--gray);
        }

        .product-detail-actions {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .quantity-selector {
            display: flex;
            align-items: center;
            border: 1px solid var(--light-gray);
            border-radius: var(--radius);
            overflow: hidden;
        }

        .quantity-btn {
            width: 40px;
            height: 40px;
            background: var(--light);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--dark);
            cursor: pointer;
        }

        .quantity-btn:hover {
            background: var(--light-gray);
        }

        .quantity-input {
            width: 50px;
            height: 40px;
            border: none;
            text-align: center;
            font-weight: 600;
            background: white;
            color: var(--dark);
        }

        .cart-items {
            max-height: 400px;
            overflow-y: auto;
        }

        .cart-item {
            display: flex;
            padding: 15px 0;
            border-bottom: 1px solid var(--light-gray);
            align-items: center;
        }

        .cart-item-image {
            width: 80px;
            height: 80px;
            border-radius: var(--radius);
            overflow: hidden;
            margin-right: 15px;
            border: 1px solid var(--light-gray);
            flex-shrink: 0;
        }

        .cart-item-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .cart-item-details {
            flex: 1;
            min-width: 0;
        }

        .cart-item-title {
            font-weight: 600;
            margin-bottom: 5px;
            font-size: 15px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .cart-item-price {
            color: var(--primary);
            font-weight: 600;
        }

        .cart-item-total {
            font-weight: 600;
            color: var(--dark);
        }

        .cart-item-actions {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-left: 10px;
        }

        .cart-item-remove {
            background: none;
            color: var(--danger);
            font-size: 18px;
            cursor: pointer;
        }

        .cart-summary {
            padding: 20px 0;
            border-top: 1px solid var(--light-gray);
        }

        .summary-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-size: 15px;
        }

        .summary-total {
            font-weight: 700;
            font-size: 18px;
            border-top: 1px solid var(--light-gray);
            padding-top: 10px;
        }

        .checkout-form {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            font-size: 14px;
            color: var(--dark);
        }

        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 10px 15px;
            border: 1px solid var(--light-gray);
            border-radius: var(--radius);
            font-family: inherit;
            background: var(--light);
            font-size: 14px;
        }

        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
            outline: none;
            border-color: var(--primary);
        }

        .form-group.full-width {
            grid-column: 1 / -1;
        }

        .payment-modal {
            text-align: center;
        }

        .payment-modal iframe {
            width: 100%;
            height: 400px;
            border: none;
            border-radius: var(--radius);
            margin: 20px 0;
        }

        .payment-processing {
            padding: 40px 0;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 4px solid var(--light-gray);
            border-top: 4px solid var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Footer - ORIGINAL */
        footer {
            background: var(--dark);
            color: white;
            padding: 60px 0 30px;
            margin-top: 40px;
        }

        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 40px;
            margin-bottom: 40px;
        }

        .footer-column h3 {
            font-size: 18px;
            margin-bottom: 20px;
            position: relative;
            padding-bottom: 10px;
            font-weight: 600;
        }

        .footer-column h3::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 40px;
            height: 2px;
            background: var(--primary);
        }

        .footer-links li {
            margin-bottom: 12px;
        }

        .footer-links a {
            color: #d4b8a0;
            transition: var(--transition);
            font-size: 14px;
        }

        .footer-links a:hover {
            color: white;
            padding-left: 5px;
        }

        .social-links {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }

        .social-link {
            width: 40px;
            height: 40px;
            background: rgba(212, 184, 160, 0.1);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
            border: 1px solid rgba(212, 184, 160, 0.2);
        }

        .social-link:hover {
            background: var(--primary);
            transform: translateY(-3px);
            border-color: var(--primary);
        }

        .footer-bottom {
            text-align: center;
            padding-top: 30px;
            border-top: 1px solid rgba(212, 184, 160, 0.1);
            color: #d4b8a0;
            font-size: 14px;
        }

        /* Loading States */
        .loading-spinner {
            text-align: center;
            padding: 40px;
            color: var(--gray);
            grid-column: 1 / -1;
        }

        .loading-spinner i {
            font-size: 40px;
            margin-bottom: 15px;
            color: var(--primary);
        }

        .error-message {
            text-align: center;
            padding: 40px;
            color: var(--danger);
            grid-column: 1 / -1;
        }

        .error-message i {
            font-size: 40px;
            margin-bottom: 15px;
        }

        .retry-btn {
            margin-top: 15px;
            padding: 8px 20px;
            background: var(--primary);
            color: white;
            border-radius: var(--radius);
            font-size: 14px;
            border: none;
            cursor: pointer;
        }

        .no-products {
            grid-column: 1 / -1;
            text-align: center;
            padding: 40px;
        }

        .no-products i {
            font-size: 48px;
            color: var(--gray);
            margin-bottom: 15px;
        }

        /* Responsive Design - ORIGINAL */
        @media (max-width: 992px) {
            .hero h1 {
                font-size: 36px;
            }
            
            .categories-grid {
                grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
            }
            
            .products-grid {
                grid-template-columns: repeat(4, 1fr);
            }
            
            .product-detail {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .mobile-menu-btn {
                display: block;
            }
            
            .search-bar {
                order: 3;
                max-width: 100%;
                margin: 15px 0 0;
                min-width: 100%;
            }
            
            .header-actions {
                gap: 10px;
            }
            
            .action-btn span {
                display: none;
            }
            
            .hero {
                padding: 40px 0;
            }
            
            .hero h1 {
                font-size: 32px;
            }
            
            .hero p {
                font-size: 16px;
            }
            
            .btn {
                padding: 10px 20px;
                font-size: 14px;
            }
            
            .btn-outline {
                margin-left: 10px;
            }
            
            .section {
                padding: 40px 0;
            }
            
            .section-title {
                font-size: 24px;
            }
            
            .categories-grid {
                grid-template-columns: repeat(4, 1fr);
                gap: 15px;
            }
            
            .category-card {
                padding: 15px 10px;
            }
            
            .category-icon {
                width: 50px;
                height: 50px;
                font-size: 20px;
            }
            
            .products-grid {
                grid-template-columns: repeat(3, 1fr);
            }
            
            .chat-window {
                width: 300px;
                height: 450px;
            }
            
            .checkout-form {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 576px) {
            .hero h1 {
                font-size: 28px;
            }
            
            .hero-actions {
                display: flex;
                flex-direction: column;
                gap: 10px;
            }
            
            .btn-outline {
                margin-left: 0;
            }
            
            .categories-grid {
                grid-template-columns: repeat(3, 1fr);
            }
            
            .products-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .steps {
                grid-template-columns: 1fr;
            }
            
            .chat-window {
                width: calc(100vw - 40px);
                right: 20px;
            }
            
            .cart-item {
                flex-wrap: wrap;
            }
            
            .cart-item-image {
                width: 60px;
                height: 60px;
            }
            
            .cart-item-actions {
                width: 100%;
                justify-content: flex-end;
                margin-top: 10px;
            }
        }

        @media (max-width: 400px) {
            .categories-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .footer-content {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Toast Container -->
    <div class="toast-container" id="toast-container"></div>

    <!-- Header -->
    <header>
        <div class="container">
            <div class="header-top">
                <a class="logo">
                    <img src="/images/haklim-logo-new.png" alt="Boutiql">
                </a>
                
                <div class="search-bar">
                    <input type="text" placeholder="Search your favorite items..." id="search-input">
                    <button id="search-btn"><i class="fas fa-search"></i><span> Search</span> </button>
                </div>
                
                <div class="header-actions">
                    <a href="#" class="action-btn" id="wishlist-btn">
                        <i class="far fa-heart"></i>
                        <span>Wishlist</span>
                    </a>
                    <a href="#" class="action-btn" id="cart-btn">
                        <i class="fas fa-shopping-bag"></i>
                        <span>Cart</span>
                        <span class="cart-count">0</span>
                    </a>
                    <button class="mobile-menu-btn">
                        <i class="fas fa-bars"></i>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Hero Section -->
    <section class="hero">
        <div class="container">
            <div class="hero-content">
                <h1>Curated Luxury & Artisan Finds</h1>
                <p>Discover exclusive boutique items, handcrafted treasures, and timeless pieces from skilled artisans worldwide.</p>
                <div class="hero-actions">
                    <a href="#" class="btn btn-primary">Explore Collection</a>
                    <a href="#" class="btn btn-outline">Pre Order</a>
                </div>
            </div>
        </div>
    </section>

    <!-- Categories Section -->
    <section class="section">
        <div class="container">
            <div class="section-header">
                <h2 class="section-title">Curated Collections</h2>
                <a href="#" class="view-all">View All <i class="fas fa-arrow-right"></i></a>
            </div>
            
            <div class="categories-container">
                <div class="categories-grid">
                    <div class="category-card">
                        <div class="category-icon">
                            <i class="fas fa-gem"></i>
                        </div>
                        <h3 class="category-name">Luxury Jewelry</h3>
                        <p class="category-count">458 items</p>
                    </div>
                    
                    <div class="category-card">
                        <div class="category-icon">
                            <i class="fas fa-tshirt"></i>
                        </div>
                        <h3 class="category-name">Designer Fashion</h3>
                        <p class="category-count">742 items</p>
                    </div>
                    
                    <div class="category-card">
                        <div class="category-icon">
                            <i class="fas fa-home"></i>
                        </div>
                        <h3 class="category-name">Home Decor</h3>
                        <p class="category-count">329 items</p>
                    </div>
                    
                    <div class="category-card">
                        <div class="category-icon">
                            <i class="fas fa-paint-brush"></i>
                        </div>
                        <h3 class="category-name">Artisan Crafts</h3>
                        <p class="category-count">287 items</p>
                    </div>
                    
                    <div class="category-card">
                        <div class="category-icon">
                            <i class="fas fa-spa"></i>
                        </div>
                        <h3 class="category-name">Beauty & Wellness</h3>
                        <p class="category-count">195 items</p>
                    </div>
                    
                    <div class="category-card">
                        <div class="category-icon">
                            <i class="fas fa-wine-glass-alt"></i>
                        </div>
                        <h3 class="category-name">Entertaining</h3>
                        <p class="category-count">128 items</p>
                    </div>
                    
                    <div class="category-card">
                        <div class="category-icon">
                            <i class="fas fa-book-open"></i>
                        </div>
                        <h3 class="category-name">Stationery</h3>
                        <p class="category-count">174 items</p>
                    </div>
                    
                    <div class="category-card">
                        <div class="category-icon">
                            <i class="fas fa-gift"></i>
                        </div>
                        <h3 class="category-name">Gift Sets</h3>
                        <p class="category-count">215 items</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Featured Products -->
    <section class="section">
        <div class="container">
            <div class="section-header">
                <h2 class="section-title">Curated Finds</h2>
                <a href="#" class="view-all">View All <i class="fas fa-arrow-right"></i></a>
            </div>
            
            <div class="products-grid" id="products-grid">
                <!-- Products will be dynamically loaded here -->
                <div class="loading-spinner">
                    <i class="fas fa-spinner fa-spin"></i>
                    <p>Loading curated collection...</p>
                </div>
            </div>
            
            <div class="pagination" id="pagination" style="display: none;"></div>
        </div>
    </section>

    <!-- How It Works -->
    <section class="section how-it-works">
        <div class="container">
            <div class="section-header">
                <h2 class="section-title">The Haklim Experience</h2>
            </div>
            
            <div class="steps">
                <div class="step">
                    <div class="step-number">1</div>
                    <h3 class="step-title">Browse Our Curated Collection</h3>
                    <p class="step-description">Explore our handpicked selection of luxury and artisan goods, each carefully selected for quality and craftsmanship.</p>
                </div>
                
                <div class="step">
                    <div class="step-number">2</div>
                    <h3 class="step-title">Personal Consultation</h3>
                    <p class="step-description">Connect directly with our boutique team for personalized advice, customization options, and care recommendations.</p>
                </div>
                
                <div class="step">
                    <div class="step-number">3</div>
                    <h3 class="step-title">Secure Your Purchase</h3>
                    <p class="step-description">Complete your purchase with our trusted payment system. Each item is authenticated and carefully prepared for shipping.</p>
                </div>
                
                <div class="step">
                    <div class="step-number">4</div>
                    <h3 class="step-title">Receive & Cherish</h3>
                    <p class="step-description">Your curated piece arrives with full authenticity guarantee, care instructions, and our commitment to excellence.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Testimonials - SPLIDE CAROUSEL -->
    <section class="section testimonials">
        <div class="container">
            <div class="section-header">
                <h2 class="section-title">Client Stories</h2>
            </div>
            
            <div class="splide" id="testimonials-splide">
                <div class="splide__track">
                    <ul class="splide__list">
                        <li class="splide__slide">
                            <div class="testimonial-card">
                                <p class="testimonial-text">"The handcrafted jewelry I found on Boutiql is absolutely exquisite. Each piece tells a story of craftsmanship I can't find elsewhere."</p>
                                <div class="testimonial-author">
                                    <div class="author-avatar">
                                        <img src="/images/marketplace_logo_base.png" alt="Isabella Laurent">
                                    </div>
                                    <div class="author-info">
                                        <h4>Isabella Laurent</h4>
                                        <p>Luxury Collector</p>
                                    </div>
                                </div>
                            </div>
                        </li>
                        
                        <li class="splide__slide">
                            <div class="testimonial-card">
                                <p class="testimonial-text">"As an interior designer, I source unique pieces from Boutiql for my clients. The quality and authenticity are consistently exceptional."</p>
                                <div class="testimonial-author">
                                    <div class="author-avatar">
                                        <img src="/images/marketplace_logo_base.png" alt="Marcus Chen">
                                    </div>
                                    <div class="author-info">
                                        <h4>Marcus Chen</h4>
                                        <p>Interior Designer</p>
                                    </div>
                                </div>
                            </div>
                        </li>
                        
                        <li class="splide__slide">
                            <div class="testimonial-card">
                                <p class="testimonial-text">"The artisan pottery collection transformed my dining experience. Each piece is a work of art that brings joy to everyday moments."</p>
                                <div class="testimonial-author">
                                    <div class="author-avatar">
                                        <img src="/images/marketplace_logo_base.png" alt="Sophie Dubois">
                                    </div>
                                    <div class="author-info">
                                        <h4>Sophie Dubois</h4>
                                        <p>Art Collector</p>
                                    </div>
                                </div>
                            </div>
                        </li>
                        
                        <li class="splide__slide">
                            <div class="testimonial-card">
                                <p class="testimonial-text">"Boutiql connects me with skilled artisans worldwide. The platform has elevated my gifting to an entirely new level of thoughtfulness."</p>
                                <div class="testimonial-author">
                                    <div class="author-avatar">
                                        <img src="/images/marketplace_logo_base.png" alt="Eleanor Vance">
                                    </div>
                                    <div class="author-info">
                                        <h4>Eleanor Vance</h4>
                                        <p>Corporate Gifting</p>
                                    </div>
                                </div>
                            </div>
                        </li>
                        
                        <li class="splide__slide">
                            <div class="testimonial-card">
                                <p class="testimonial-text">"The attention to detail in every piece is remarkable. I've built my entire home decor collection from Boutiql finds."</p>
                                <div class="testimonial-author">
                                    <div class="author-avatar">
                                        <img src="/images/marketplace_logo_base.png" alt="David Miller">
                                    </div>
                                    <div class="author-info">
                                        <h4>David Miller</h4>
                                        <p>Architect</p>
                                    </div>
                                </div>
                            </div>
                        </li>
                        
                        <li class="splide__slide">
                            <div class="testimonial-card">
                                <p class="testimonial-text">"Every purchase feels special. The packaging, the authenticity certificates, and the personal notes make all the difference."</p>
                                <div class="testimonial-author">
                                    <div class="author-avatar">
                                        <img src="/images/marketplace_logo_base.png" alt="Rachel Green">
                                    </div>
                                    <div class="author-info">
                                        <h4>Rachel Green</h4>
                                        <p>Fashion Editor</p>
                                    </div>
                                </div>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </section>

    <!-- Chat System -->
    <div class="chat-container">
        <button class="chat-button" id="chat-toggle">
            <i class="fas fa-headset"></i>
            <span class="chat-status-badge online" id="chat-status-badge"></span>
        </button>
        
        <div class="chat-window" id="chat-window">
            <div class="chat-header">
                <h3><i class="fas fa-headset"></i> Customer Support</h3>
                <button class="chat-close" id="chat-close"><i class="fas fa-times"></i></button>
            </div>
            
            <div class="chat-support-info" id="chat-support-info">
                <div class="support-avatar">
                    <i class="fas fa-user"></i>
                </div>
                <div class="support-details">
                    <h4>Haklim Support Team</h4>
                    <p>
                        <span class="support-status online" id="support-status"></span>
                        <span id="support-status-text">Online</span>
                    </p>
                    <div class="support-hours" id="support-hours">Mon-Fri: 9am-6pm EST</div>
                </div>
            </div>
            
            <div class="chat-messages" id="chat-messages">
                <!-- Messages will be dynamically loaded here -->
            </div>
            
            <div class="chat-input-area" id="chat-input-area" style="display: none;">
                <input type="text" placeholder="Type your message..." id="chat-input">
                <button class="chat-send" id="chat-send"><i class="fas fa-paper-plane"></i></button>
            </div>
            
            <div class="offline-message-form" id="offline-message-form" style="display: none;">
                <textarea id="offline-message" placeholder="Leave us a message and we'll get back to you during business hours..." rows="3"></textarea>
                <input type="email" id="offline-email" placeholder="Your email address">
                <button id="send-offline-message">Send Message</button>
            </div>
        </div>
    </div>

    <!-- Product Detail Modal -->
    <div class="modal" id="product-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Product Details</h2>
                <button class="modal-close" id="product-modal-close"><i class="fas fa-times"></i></button>
            </div>
            <div class="modal-body">
                <div class="product-detail">
                    <div class="product-detail-image">
                        <img src="/images/marketplace_logo_base.png" alt="Product Image" id="modal-product-image">
                    </div>
                    <div class="product-detail-info">
                        <h2 id="modal-product-title">Product Title</h2>
                        <div class="product-detail-price" id="modal-product-price">$0.00</div>
                        <p class="product-detail-category" id="modal-product-category"></p>
                        <p class="product-detail-description" id="modal-product-description">Product description goes here...</p>
                        <div class="product-detail-actions">
                            <div class="quantity-selector">
                                <button class="quantity-btn" id="quantity-decrease">-</button>
                                <input type="text" class="quantity-input" id="quantity-input" value="1" readonly>
                                <button class="quantity-btn" id="quantity-increase">+</button>
                            </div>
                            <button class="btn btn-primary" id="add-to-cart-modal">Add to Cart</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Cart Modal -->
    <div class="modal" id="cart-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Your Curated Selection</h2>
                <button class="modal-close" id="cart-modal-close"><i class="fas fa-times"></i></button>
            </div>
            <div class="modal-body">
                <div class="cart-items" id="cart-items">
                    <!-- Cart items will be dynamically loaded here -->
                </div>
                
                <div class="cart-summary">
                    <div class="summary-row">
                        <span>Subtotal:</span>
                        <span id="cart-subtotal">$0.00</span>
                    </div>
                    <div class="summary-row">
                        <span>Shipping:</span>
                        <span id="cart-shipping">$12.99</span>
                    </div>
                    <div class="summary-row">
                        <span>Tax:</span>
                        <span id="cart-tax">$0.00</span>
                    </div>
                    <div class="summary-row summary-total">
                        <span>Total:</span>
                        <span id="cart-total">$0.00</span>
                    </div>
                </div>
                
                <div class="cart-actions" style="display: flex; justify-content: space-between; margin-top: 20px;">
                    <button class="btn" style="background: var(--light); border: 1px solid var(--light-gray);" id="continue-shopping">Continue Shopping</button>
                    <button class="btn btn-primary" id="checkout-btn">Proceed to Checkout</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Checkout Modal -->
    <div class="modal" id="checkout-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Complete Your Order</h2>
                <button class="modal-close" id="checkout-modal-close"><i class="fas fa-times"></i></button>
            </div>
            <div class="modal-body">
                <form class="checkout-form" id="checkout-form">
                    <div class="form-group">
                        <label for="full-name">Full Name</label>
                        <input type="text" id="full-name" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="email">Email Address</label>
                        <input type="email" id="email" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="phone">Phone Number</label>
                        <input type="tel" id="phone" required>
                    </div>
                    
                    <div class="form-group full-width">
                        <label for="address">Shipping Address</label>
                        <input type="text" id="address" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="city">City</label>
                        <input type="text" id="city" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="state">State</label>
                        <input type="text" id="state" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="zip">ZIP Code</label>
                        <input type="text" id="zip" required>
                    </div>
                    
                    <div class="form-group full-width">
                        <label for="delivery-method">Delivery Method</label>
                        <select id="delivery-method" required>
                            <option value="">Select delivery method</option>
                            <option value="store1">Store Pickup - Nairobi CBD</option>
                            <option value="store2">Store Pickup - Westlands</option>
                            <option value="doorstep">Doorstep Delivery</option>
                        </select>
                    </div>
                    
                    <div id="address-fields" style="display: none;">
                        <div class="form-group">
                            <label for="country">Country</label>
                            <input type="text" id="country">
                        </div>
                        <div class="form-group">
                            <label for="area">Area/Neighborhood</label>
                            <input type="text" id="area">
                        </div>
                    </div>
                    
                    <div class="form-group full-width">
                        <label for="payment-method">Payment Method</label>
                        <select id="payment-method" required>
                            <option value="">Select Payment Method</option>
                            <option value="mpesa">M-Pesa</option>
                            <option value="pesapal">PesaPal</option>
                            <option value="visa">Visa</option>
                            <option value="airtel">Airtel Money</option>
                        </select>
                    </div>
                    
                    <div class="form-group full-width">
                        <button type="submit" class="btn btn-primary" style="width: 100%;" id="complete-purchase-btn">Complete Purchase</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Payment Modal -->
    <div class="modal" id="payment-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Processing Payment</h2>
                <button class="modal-close" id="payment-modal-close"><i class="fas fa-times"></i></button>
            </div>
            <div class="modal-body payment-modal">
                <div class="payment-processing" id="payment-processing">
                    <div class="spinner"></div>
                    <p>Please wait while we process your payment...</p>
                </div>
                <div id="payment-iframe-container" style="display: none;">
                    <iframe id="payment-iframe" src="about:blank"></iframe>
                    <button class="btn btn-outline" id="cancel-payment-btn" style="margin-top: 20px;">Cancel Payment</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-column">
                    <h3>Haklim Fashions</h3>
                    <p style="color: #d4b8a0; font-size: 14px;">Curated luxury and artisan finds for the discerning collector. Each piece tells a story.</p>
                    <div class="social-links">
                        <a href="#" class="social-link"><i class="fab fa-instagram"></i></a>
                        <a href="#" class="social-link"><i class="fab fa-pinterest-p"></i></a>
                        <a href="#" class="social-link"><i class="fab fa-etsy"></i></a>
                        <a href="#" class="social-link"><i class="far fa-envelope"></i></a>
                    </div>
                </div>
                
                <div class="footer-column">
                    <h3>Collections</h3>
                    <ul class="footer-links">
                        <li><a href="#">New Arrivals</a></li>
                        <li><a href="#">Limited Editions</a></li>
                        <li><a href="#">Artisan Spotlight</a></li>
                        <li><a href="#">Vintage Finds</a></li>
                        <li><a href="#">Gift Guide</a></li>
                    </ul>
                </div>
                
                <div class="footer-column">
                    <h3>Services</h3>
                    <ul class="footer-links">
                        <li><a href="#">Personal Shopping</a></li>
                        <li><a href="#">Gift Wrapping</a></li>
                        <li><a href="#">Authenticity Guarantee</a></li>
                        <li><a href="#">Care Instructions</a></li>
                        <li><a href="#">Privacy Policy</a></li>
                    </ul>
                </div>
                
                <div class="footer-column">
                    <h3>Contact</h3>
                    <ul class="footer-links">
                        <li><i class="fas fa-map-marker-alt"></i> 451 Street, Toronto - Canada</li>
                        <li><i class="fas fa-phone"></i> +1 (555) 867-5309</li>
                        <li><i class="fas fa-envelope"></i> support@haklimfashions.com</li>
                        <li><i class="far fa-clock"></i> Mon-Fri: 9am-6pm EST</li>
                    </ul>
                </div>
            </div>
            
            <div class="footer-bottom">
                <p>&copy; 2026 Haklim Fashions - Curated luxury marketplace. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/@splidejs/splide@4.1.4/dist/js/splide.min.js"></script>
    <script>
        (function() {
            // ========== CONFIGURATION ==========
            const PRODUCTS_PER_PAGE = 12;

            // ========== STATE MANAGEMENT ==========
            let products = [];
            let currentPage = 1;
            let totalPages = 1;
            let cart = [];
            let currentProduct = null;

            // Load cart from localStorage
            try {
                const savedCart = localStorage.getItem('cart');
                if (savedCart) {
                    cart = JSON.parse(savedCart);
                }
            } catch (e) {
                console.error('Error loading cart:', e);
            }

            // ========== UTILITY FUNCTIONS ==========

            // Format number with commas
            function formatNumber(num) {
                return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
            }

            // Format price with commas
            function formatPrice(price) {
                return '$' + formatNumber(price.toFixed(2));
            }

            // Toast notification system
            function showToast(message, type = 'info', title = '') {
                const container = document.getElementById('toast-container');
                const toast = document.createElement('div');
                toast.className = `toast ${type}`;
                
                const icons = {
                    success: 'fa-check-circle',
                    error: 'fa-exclamation-circle',
                    info: 'fa-info-circle'
                };
                
                const titles = {
                    success: 'Success',
                    error: 'Error',
                    info: 'Information'
                };
                
                toast.innerHTML = `
                    <div class="toast-icon">
                        <i class="fas ${icons[type]}"></i>
                    </div>
                    <div class="toast-content">
                        <div class="toast-title">${title || titles[type]}</div>
                        <div class="toast-message">${message}</div>
                    </div>
                    <div class="toast-progress"></div>
                `;
                
                container.appendChild(toast);
                
                setTimeout(() => {
                    toast.remove();
                }, 3000);
            }

            // ========== API CALLS ==========

            // Fetch products - simple GET without params
            async function fetchProducts() {
                try {
                    const response = await fetch('/fetch/get-products');
                    
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    
                    const data = await response.json();
                    
                    if (data && data.length > 0) {
                        products = data.map(item => ({
                            id: item.id,
                            title: item.name,
                            category: item.category,
                            price: item.discount ? item.discounted_price : item.price,
                            oldPrice: item.discount ? item.price : null,
                            discount: item.discount ? Math.round((item.discount / item.price) * 100) : 0,
                            image: item.images && item.images.length > 0 ? item.images[0] : '/images/marketplace_logo_base.png',
                            description: item.description,
                            brand: item.brand,
                            stock: item.stock,
                            badge: item.badge,
                            features: item.features
                        }));
                        
                        totalPages = Math.ceil(products.length / PRODUCTS_PER_PAGE);
                        
                        renderProducts();
                        setupPagination();
                    } else {
                        showNoProducts();
                    }
                } catch (error) {
                    console.error('Error fetching products:', error);
                    showError('Failed to load products. Please try again.');
                }
            }

            // Place order
            async function placeOrder(orderData) {
                const response = await fetch('/checkout/place-order', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(orderData)
                });

                const result = await response.json();

                if (!response.ok) {
                    throw new Error(result.message || 'Failed to process order');
                }

                return result;
            }

            // ========== RENDERING FUNCTIONS ==========

            function renderProducts() {
                const grid = document.getElementById('products-grid');
                
                if (!products.length) {
                    showNoProducts();
                    return;
                }
                
                const startIndex = (currentPage - 1) * PRODUCTS_PER_PAGE;
                const endIndex = startIndex + PRODUCTS_PER_PAGE;
                const paginatedProducts = products.slice(startIndex, endIndex);
                
                grid.innerHTML = paginatedProducts.map(product => {
                    const discountBadge = product.discount ? `<div class="product-badge">${product.discount}% OFF</div>` : '';
                    const oldPrice = product.oldPrice ? `<span class="product-price-old">${formatPrice(product.oldPrice)}</span>` : '';
                    const badge = product.badge ? `<div class="product-badge">${product.badge}</div>` : '';
                    
                    return `
                        <div class="product-card" data-id="${product.id}">
                            <div class="product-image">
                                <img src="${product.image}" alt="${product.title}" loading="lazy">
                                ${discountBadge || badge}
                                <button class="product-wishlist" onclick="event.stopPropagation(); window.toggleWishlist(this, '${product.id}')">
                                    <i class="far fa-heart"></i>
                                </button>
                            </div>
                            <div class="product-info">
                                <p class="product-category">${product.category}</p>
                                <h3 class="product-title">${product.title}</h3>
                                <div class="product-price">
                                    ${oldPrice}
                                    ${formatPrice(product.price)}
                                </div>
                                <div class="product-actions">
                                    <button class="btn-add-to-cart" onclick="event.stopPropagation(); window.addToCartDirect('${product.id}')">
                                        <i class="fas fa-shopping-bag"></i> Add to Cart
                                    </button>
                                </div>
                            </div>
                        </div>
                    `;
                }).join('');
            }

            function showNoProducts() {
                document.getElementById('products-grid').innerHTML = `
                    <div class="no-products">
                        <i class="fas fa-box-open"></i>
                        <h3>No products found</h3>
                        <p>Check back soon for our latest collection</p>
                    </div>
                `;
            }

            function showError(message) {
                document.getElementById('products-grid').innerHTML = `
                    <div class="error-message">
                        <i class="fas fa-exclamation-circle"></i>
                        <p>${message}</p>
                        <button class="retry-btn" onclick="window.fetchProducts()">Try Again</button>
                    </div>
                `;
            }

            function setupPagination() {
                const pagination = document.getElementById('pagination');
                
                if (totalPages <= 1) {
                    pagination.style.display = 'none';
                    return;
                }
                
                pagination.style.display = 'flex';
                
                let paginationHtml = `
                    <button class="pagination-btn" id="prev-page" ${currentPage === 1 ? 'disabled' : ''}>
                        <i class="fas fa-chevron-left"></i>
                    </button>
                `;
                
                for (let i = 1; i <= totalPages; i++) {
                    paginationHtml += `
                        <button class="pagination-btn ${i === currentPage ? 'active' : ''}" data-page="${i}">
                            ${i}
                        </button>
                    `;
                }
                
                paginationHtml += `
                    <button class="pagination-btn" id="next-page" ${currentPage === totalPages ? 'disabled' : ''}>
                        <i class="fas fa-chevron-right"></i>
                    </button>
                `;
                
                pagination.innerHTML = paginationHtml;
                
                document.getElementById('prev-page').addEventListener('click', () => {
                    if (currentPage > 1) {
                        currentPage--;
                        renderProducts();
                        setupPagination();
                        window.scrollTo({ top: 0, behavior: 'smooth' });
                    }
                });
                
                document.getElementById('next-page').addEventListener('click', () => {
                    if (currentPage < totalPages) {
                        currentPage++;
                        renderProducts();
                        setupPagination();
                        window.scrollTo({ top: 0, behavior: 'smooth' });
                    }
                });
                
                document.querySelectorAll('.pagination-btn[data-page]').forEach(btn => {
                    btn.addEventListener('click', () => {
                        const page = parseInt(btn.dataset.page);
                        if (page !== currentPage) {
                            currentPage = page;
                            renderProducts();
                            setupPagination();
                            window.scrollTo({ top: 0, behavior: 'smooth' });
                        }
                    });
                });
            }

            // ========== CART FUNCTIONS ==========

            window.addToCartDirect = function(productId) {
                const product = products.find(p => p.id == productId);
                if (!product) return;
                
                const existingItem = cart.find(item => item.id == productId);
                
                if (existingItem) {
                    existingItem.quantity += 1;
                    showToast(`Increased quantity of "${product.title}"`, 'success', 'Cart Updated');
                } else {
                    cart.push({
                        id: product.id,
                        title: product.title,
                        price: product.price,
                        image: product.image,
                        quantity: 1
                    });
                    showToast(`"${product.title}" added to cart`, 'success', 'Item Added');
                }
                
                saveCart();
                updateCartCount();
                
                const btn = document.querySelector(`.btn-add-to-cart[onclick*="'${productId}'"]`);
                if (btn) {
                    const originalText = btn.innerHTML;
                    btn.innerHTML = '<i class="fas fa-check"></i> Added';
                    btn.style.background = 'var(--success)';
                    
                    setTimeout(() => {
                        btn.innerHTML = originalText;
                        btn.style.background = '';
                    }, 1500);
                }
            };

            window.removeFromCart = function(productId) {
                const item = cart.find(item => item.id == productId);
                if (item) {
                    cart = cart.filter(item => item.id != productId);
                    saveCart();
                    updateCartCount();
                    if (document.getElementById('cart-modal').classList.contains('active')) {
                        renderCartItems();
                    }
                    showToast(`"${item.title}" removed from cart`, 'info', 'Item Removed');
                }
            };

            function updateCartCount() {
                const totalItems = cart.reduce((total, item) => total + item.quantity, 0);
                document.querySelectorAll('.cart-count').forEach(el => {
                    el.textContent = totalItems;
                });
            }

            function saveCart() {
                localStorage.setItem('cart', JSON.stringify(cart));
            }

            function renderCartItems() {
                const container = document.getElementById('cart-items');
                
                if (cart.length === 0) {
                    container.innerHTML = '<p style="text-align: center; padding: 20px; color: var(--gray);">Your curated selection is empty</p>';
                    document.getElementById('cart-subtotal').textContent = '$0.00';
                    document.getElementById('cart-tax').textContent = '$0.00';
                    document.getElementById('cart-shipping').textContent = '$12.99';
                    document.getElementById('cart-total').textContent = '$12.99';
                    return;
                }
                
                let subtotal = 0;
                
                container.innerHTML = cart.map(item => {
                    const itemTotal = item.price * item.quantity;
                    subtotal += itemTotal;
                    
                    return `
                        <div class="cart-item">
                            <div class="cart-item-image">
                                <img src="${item.image}" alt="${item.title}" loading="lazy">
                            </div>
                            <div class="cart-item-details">
                                <h3 class="cart-item-title">${item.title}</h3>
                                <div class="cart-item-price">${formatPrice(item.price)} x ${item.quantity}</div>
                                <div class="cart-item-total">${formatPrice(itemTotal)}</div>
                            </div>
                            <div class="cart-item-actions">
                                <button class="cart-item-remove" onclick="window.removeFromCart('${item.id}')">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                    `;
                }).join('');
                
                const tax = subtotal * 0.08;
                const shipping = 12.99;
                const total = subtotal + tax + shipping;
                
                document.getElementById('cart-subtotal').textContent = formatPrice(subtotal);
                document.getElementById('cart-tax').textContent = formatPrice(tax);
                document.getElementById('cart-shipping').textContent = '$12.99';
                document.getElementById('cart-total').textContent = formatPrice(total);
            }

            // ========== CHAT FUNCTIONS ==========

            function checkSupportOnline() {
                const now = new Date();
                const day = now.getDay();
                const hour = now.getHours();
                
                const estOffset = -5;
                const localOffset = now.getTimezoneOffset() / 60;
                const estHour = hour - localOffset + estOffset;
                
                let estDay = day;
                if (estHour < 0) {
                    estDay = (day - 1 + 7) % 7;
                } else if (estHour >= 24) {
                    estDay = (day + 1) % 7;
                }
                
                const adjustedHour = estHour < 0 ? estHour + 24 : (estHour >= 24 ? estHour - 24 : estHour);
                
                const isWeekday = estDay >= 1 && estDay <= 5;
                const isBusinessHours = adjustedHour >= 9 && adjustedHour < 18;
                
                return isWeekday && isBusinessHours;
            }

            function updateChatStatus() {
                const isOnline = checkSupportOnline();
                const statusBadge = document.getElementById('chat-status-badge');
                const supportStatus = document.getElementById('support-status');
                const statusText = document.getElementById('support-status-text');
                const chatToggle = document.getElementById('chat-toggle');
                
                if (isOnline) {
                    statusBadge.className = 'chat-status-badge online';
                    supportStatus.className = 'support-status online';
                    statusText.textContent = 'Online';
                    chatToggle.classList.remove('offline');
                } else {
                    statusBadge.className = 'chat-status-badge offline';
                    supportStatus.className = 'support-status offline';
                    statusText.textContent = 'Offline';
                    chatToggle.classList.add('offline');
                }
            }

            function initChat() {
                const isOnline = checkSupportOnline();
                const messages = document.getElementById('chat-messages');
                const inputArea = document.getElementById('chat-input-area');
                const offlineForm = document.getElementById('offline-message-form');
                
                messages.innerHTML = '';
                
                if (isOnline) {
                    inputArea.style.display = 'flex';
                    offlineForm.style.display = 'none';
                    document.getElementById('chat-input').disabled = false;
                    document.getElementById('chat-send').disabled = false;
                    
                    const welcomeMsg = document.createElement('div');
                    welcomeMsg.className = 'message support';
                    welcomeMsg.innerHTML = `
                        <div>Hello! I'm Sarah from Haklim Support. How can I assist you today?</div>
                        <div class="message-time">${new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}</div>
                    `;
                    messages.appendChild(welcomeMsg);
                } else {
                    inputArea.style.display = 'none';
                    offlineForm.style.display = 'block';
                    
                    const offlineMsg = document.createElement('div');
                    offlineMsg.className = 'message system';
                    offlineMsg.innerHTML = `
                        <div> We're currently offline. Our support hours are Monday-Friday, 9am-6pm EST. Please leave us a message and we'll get back to you during business hours.</div>
                    `;
                    messages.appendChild(offlineMsg);
                }
            }

            function sendChatMessage() {
                const input = document.getElementById('chat-input');
                const message = input.value.trim();
                
                if (!message) return;
                
                const messages = document.getElementById('chat-messages');
                
                const customerMsg = document.createElement('div');
                customerMsg.className = 'message customer';
                customerMsg.innerHTML = `
                    <div>${message}</div>
                    <div class="message-time">${new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}</div>
                `;
                messages.appendChild(customerMsg);
                
                input.value = '';
                
                messages.scrollTop = messages.scrollHeight;
                
                setTimeout(() => {
                    const responses = [
                        "Thank you for reaching out. I'd be happy to help with that.",
                        "Let me check that for you. One moment please.",
                        "I can assist you with your inquiry about our products.",
                        "Would you like me to provide more details about that item?",
                        "I've noted your question and will help you right away."
                    ];
                    const response = responses[Math.floor(Math.random() * responses.length)];
                    
                    const supportMsg = document.createElement('div');
                    supportMsg.className = 'message support';
                    supportMsg.innerHTML = `
                        <div>${response}</div>
                        <div class="message-time">${new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}</div>
                    `;
                    messages.appendChild(supportMsg);
                    messages.scrollTop = messages.scrollHeight;
                }, 1000 + Math.random() * 2000);
            }

            function sendOfflineMessage() {
                const message = document.getElementById('offline-message').value.trim();
                const email = document.getElementById('offline-email').value.trim();
                
                if (!message) {
                    showToast('Please enter a message', 'error', 'Missing Message');
                    return;
                }
                
                if (!email || !email.includes('@')) {
                    showToast('Please enter a valid email address', 'error', 'Invalid Email');
                    return;
                }
                
                console.log('Offline message:', { message, email });
                showToast('Message sent! We\'ll get back to you soon.', 'success', 'Message Sent');
                
                const form = document.getElementById('offline-message-form');
                form.innerHTML = `
                    <div style="text-align: center; padding: 20px;">
                        <i class="fas fa-check-circle" style="font-size: 48px; color: var(--success); margin-bottom: 15px;"></i>
                        <h4 style="margin-bottom: 10px;">Message Sent!</h4>
                        <p style="color: var(--gray); margin-bottom: 15px;">We'll get back to you at ${email} during business hours.</p>
                        <button class="btn btn-primary" onclick="window.initChat()">Send Another Message</button>
                    </div>
                `;
            }

            // ========== MODAL FUNCTIONS ==========

            function openProductModal(productId) {
                const product = products.find(p => p.id == productId);
                if (!product) return;
                
                currentProduct = product;
                
                document.getElementById('modal-product-image').src = product.image;
                document.getElementById('modal-product-title').textContent = product.title;
                document.getElementById('modal-product-price').textContent = formatPrice(product.price);
                document.getElementById('modal-product-category').textContent = product.category;
                document.getElementById('modal-product-description').textContent = product.description;
                document.getElementById('quantity-input').value = 1;
                
                document.getElementById('product-modal').classList.add('active');
                document.body.style.overflow = 'hidden';
            }

            function closeModal(modalId) {
                document.getElementById(modalId).classList.remove('active');
                document.body.style.overflow = 'auto';
            }

            // ========== WISHLIST FUNCTION ==========

            window.toggleWishlist = function(btn, productId) {
                btn.classList.toggle('active');
                const icon = btn.querySelector('i');
                if (btn.classList.contains('active')) {
                    icon.className = 'fas fa-heart';
                    showToast('Item added to wishlist', 'success', 'Wishlist');
                } else {
                    icon.className = 'far fa-heart';
                    showToast('Item removed from wishlist', 'info', 'Wishlist');
                }
            };

            // ========== CHECKOUT FUNCTIONS ==========

            async function handleCheckoutSubmit(e) {
                e.preventDefault();
                
                const form = e.target;
                const submitBtn = document.getElementById('complete-purchase-btn');
                submitBtn.disabled = true;
                submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
                
                try {
                    const formData = new FormData(form);
                    const formValues = Object.fromEntries(formData.entries());
                    
                    const orderData = {
                        cart: cart.map(item => ({
                            id: item.id,
                            quantity: item.quantity
                        })),
                        customerInfo: {
                            firstname: formValues['full-name'].split(' ')[0] || '',
                            lastname: formValues['full-name'].split(' ').slice(1).join(' ') || '',
                            email: formValues.email,
                            telephone: formValues.phone,
                            delivery_method: formValues['delivery-method'],
                            delivery_address: formValues['delivery-method'] === 'doorstep' ? {
                                country: formValues.country,
                                city: formValues.city,
                                area: formValues.area
                            } : null
                        },
                        paymentMethod: formValues['payment-method']
                    };
                    
                    const result = await placeOrder(orderData);
                    
                    if (result.success) {
                        cart = [];
                        saveCart();
                        updateCartCount();
                        
                        closeModal('checkout-modal');
                        
                        document.getElementById('payment-modal').classList.add('active');
                        document.querySelector('.payment-processing').style.display = 'block';
                        document.getElementById('payment-iframe-container').style.display = 'none';
                        
                        setTimeout(() => {
                            document.querySelector('.payment-processing').style.display = 'none';
                            document.getElementById('payment-iframe-container').style.display = 'block';
                            document.getElementById('payment-iframe').src = result.redirectUrl || 'about:blank';
                        }, 2000);
                        
                        showToast('Order placed successfully! Redirecting to payment...', 'success', 'Order Confirmed');
                    } else {
                        throw new Error(result.message || 'Checkout failed');
                    }
                } catch (error) {
                    console.error('Checkout error:', error);
                    showToast(error.message || 'An error occurred during checkout', 'error', 'Checkout Failed');
                    submitBtn.disabled = false;
                    submitBtn.textContent = 'Complete Purchase';
                }
            }

            // ========== SEARCH FUNCTION ==========

            function handleSearch() {
                const query = document.getElementById('search-input').value.trim().toLowerCase();
                
                if (!query) {
                    fetchProducts();
                    return;
                }
                
                const filtered = products.filter(p => 
                    p.title.toLowerCase().includes(query) || 
                    p.category.toLowerCase().includes(query) ||
                    p.description.toLowerCase().includes(query)
                );
                
                if (filtered.length > 0) {
                    products = filtered;
                    currentPage = 1;
                    totalPages = Math.ceil(products.length / PRODUCTS_PER_PAGE);
                    renderProducts();
                    setupPagination();
                    showToast(`Found ${filtered.length} products matching "${query}"`, 'success', 'Search Results');
                } else {
                    document.getElementById('products-grid').innerHTML = `
                        <div class="no-products">
                            <i class="fas fa-search"></i>
                            <h3>No products found for "${query}"</h3>
                            <p>Try different keywords or browse our categories</p>
                            <button class="btn btn-primary" style="margin-top: 20px;" onclick="window.fetchProducts()">View All Products</button>
                        </div>
                    `;
                    document.getElementById('pagination').style.display = 'none';
                }
            }

            // ========== INITIALIZE SPLIDE ==========

            function initSplide() {
                if (typeof Splide !== 'undefined') {
                    new Splide('#testimonials-splide', {
                        type: 'loop',
                        perPage: 3,
                        perMove: 1,
                        gap: '25px',
                        pagination: true,
                        arrows: true,
                        autoplay: true,
                        interval: 5000,
                        breakpoints: {
                            992: {
                                perPage: 2,
                            },
                            768: {
                                perPage: 1,
                            }
                        }
                    }).mount();
                }
            }

            // ========== EVENT LISTENERS SETUP ==========

            function setupEventListeners() {
                document.addEventListener('click', (e) => {
                    const card = e.target.closest('.product-card');
                    if (card && !e.target.closest('.btn-add-to-cart') && !e.target.closest('.product-wishlist')) {
                        const id = card.dataset.id;
                        openProductModal(id);
                    }
                });
                
                document.getElementById('product-modal-close').addEventListener('click', () => closeModal('product-modal'));
                document.getElementById('cart-modal-close').addEventListener('click', () => closeModal('cart-modal'));
                document.getElementById('checkout-modal-close').addEventListener('click', () => closeModal('checkout-modal'));
                document.getElementById('payment-modal-close').addEventListener('click', () => closeModal('payment-modal'));
                
                document.querySelectorAll('.modal').forEach(modal => {
                    modal.addEventListener('click', (e) => {
                        if (e.target === modal) {
                            modal.classList.remove('active');
                            document.body.style.overflow = 'auto';
                        }
                    });
                });
                
                document.getElementById('cart-btn').addEventListener('click', (e) => {
                    e.preventDefault();
                    renderCartItems();
                    document.getElementById('cart-modal').classList.add('active');
                    document.body.style.overflow = 'hidden';
                });
                
                document.getElementById('continue-shopping').addEventListener('click', () => {
                    closeModal('cart-modal');
                });
                
                document.getElementById('quantity-decrease').addEventListener('click', () => {
                    const input = document.getElementById('quantity-input');
                    let value = parseInt(input.value);
                    if (value > 1) input.value = value - 1;
                });
                
                document.getElementById('quantity-increase').addEventListener('click', () => {
                    const input = document.getElementById('quantity-input');
                    let value = parseInt(input.value);
                    input.value = value + 1;
                });
                
                document.getElementById('add-to-cart-modal').addEventListener('click', () => {
                    if (!currentProduct) return;
                    
                    const quantity = parseInt(document.getElementById('quantity-input').value);
                    const existingItem = cart.find(item => item.id == currentProduct.id);
                    
                    if (existingItem) {
                        existingItem.quantity += quantity;
                    } else {
                        cart.push({
                            id: currentProduct.id,
                            title: currentProduct.title,
                            price: currentProduct.price,
                            image: currentProduct.image,
                            quantity: quantity
                        });
                    }
                    
                    saveCart();
                    updateCartCount();
                    closeModal('product-modal');
                    showToast(`Added ${quantity} "${currentProduct.title}" to cart`, 'success', 'Item Added');
                });
                
                document.getElementById('checkout-btn').addEventListener('click', () => {
                    if (cart.length === 0) {
                        showToast('Your cart is empty', 'error', 'Cannot Checkout');
                        return;
                    }
                    closeModal('cart-modal');
                    document.getElementById('checkout-modal').classList.add('active');
                    document.body.style.overflow = 'hidden';
                });
                
                document.getElementById('checkout-form').addEventListener('submit', handleCheckoutSubmit);
                
                document.getElementById('delivery-method').addEventListener('change', (e) => {
                    const addressFields = document.getElementById('address-fields');
                    addressFields.style.display = e.target.value === 'doorstep' ? 'block' : 'none';
                });
                
                document.getElementById('cancel-payment-btn').addEventListener('click', () => {
                    closeModal('payment-modal');
                    showToast('Payment cancelled', 'info', 'Cancelled');
                });
                
                document.getElementById('chat-toggle').addEventListener('click', () => {
                    const window = document.getElementById('chat-window');
                    window.classList.toggle('active');
                    if (window.classList.contains('active')) {
                        initChat();
                    }
                });
                
                document.getElementById('chat-close').addEventListener('click', () => {
                    document.getElementById('chat-window').classList.remove('active');
                });
                
                document.getElementById('chat-send').addEventListener('click', sendChatMessage);
                document.getElementById('chat-input').addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') sendChatMessage();
                });
                
                document.getElementById('send-offline-message').addEventListener('click', sendOfflineMessage);
                
                document.getElementById('search-btn').addEventListener('click', handleSearch);
                document.getElementById('search-input').addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') handleSearch();
                });
                
                document.querySelector('.mobile-menu-btn').addEventListener('click', () => {
                    showToast('Mobile menu coming soon', 'info', 'Under Development');
                });
                
                document.getElementById('wishlist-btn').addEventListener('click', (e) => {
                    e.preventDefault();
                    showToast('Wishlist feature coming soon', 'info', 'Under Development');
                });
                
                document.querySelectorAll('.category-card').forEach(card => {
                    card.addEventListener('click', () => {
                        const category = card.querySelector('.category-name').textContent;
                        showToast(`Browsing ${category} category`, 'info', 'Category');
                    });
                });
                
                document.querySelectorAll('.view-all').forEach(link => {
                    link.addEventListener('click', (e) => {
                        e.preventDefault();
                        showToast('View all feature coming soon', 'info', 'Under Development');
                    });
                });
                
                document.querySelectorAll('.hero-actions .btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        e.preventDefault();
                        if (btn.textContent.includes('Explore')) {
                            document.getElementById('products-grid').scrollIntoView({ behavior: 'smooth' });
                        } else {
                            showToast('Pre-order feature coming soon', 'info', 'Under Development');
                        }
                    });
                });
            }

            // ========== INITIALIZATION ==========

            function init() {
                fetchProducts();
                updateCartCount();
                updateChatStatus();
                setupEventListeners();
                initSplide();
                
                setInterval(updateChatStatus, 60000);
            }

            window.fetchProducts = fetchProducts;
            window.initChat = initChat;

            document.addEventListener('DOMContentLoaded', init);
        })();
    </script>
</body>
</html>
